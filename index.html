<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/izitoast/1.4.0/css/iziToast.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/izitoast/1.4.0/js/iziToast.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="./css/index.css">
    <link rel="stylesheet" href="./bot/bot.css">
    <style>
      .d-none {
        display: none !important; /* Ensure the section is hidden */
      }
      .d-flex {
        display: flex !important; /* Ensure the section is shown */
      }
      input[type="number"]::-webkit-inner-spin-button,
input[type="number"]::-webkit-outer-spin-button {
  -webkit-appearance: none;
  margin: 0;
}

/* Hide spinner controls in Firefox */
input[type="number"] {
  -moz-appearance: textfield;
}

/* Hide spinner controls in Edge */
input[type="number"]::-ms-expand {
  display: none;
}
    </style>

    <title>Document</title>
</head>
<body>

    <div class="main">
      <nav class="navbar navbar-expand-lg bg-body-tertiary">
        <div class="container-fluid">
          <a class="navbar-brand ms-auto" href="./index.html">Navbar</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
              <li class="nav-item">
                <a class="nav-link active" aria-current="page" href="./index.html">Home</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="./mybots.html">My Bots</a>
              </li>
              <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                  Wallet
                </a>
                <ul class="dropdown-menu">
                  <li><a class="dropdown-item" href="./deposite.html">Deposit</a></li>
                  <li><a class="dropdown-item" href="./withdrawal.html">Withdrawal</a></li>
                </ul>
              </li>
              <li class="nav-item">
                <a class="nav-link disabled" aria-disabled="true">Logout</a>
              </li>
            </ul>
          </div>
        </div>
      </nav>

      <div class="container-fluid p-0">
        <div class="welcome-container">
          <div class="welcome-message d-flex justify-content-start ms-0 ps-3">
            <span>Welcome, User!</span>
          </div>
        </div>

      </div>

        <header>
          <div class="wallet-amount d-flex justify-content-end me-3">
            <span>Wallet Amount: $0.00</span>
          </div>
          
         <div class="container-fluid p-0 m-0">
           <div class="row p-0 m-0">
             <div class="col-12  hero-text-container">
                    <div class="overlay"></div>
                    <div class="container col-md-6">
                        <h1>Maximize Your Crypto Returns with Automated Trading</h1> <br/>
                    <p>Let handle the hardwork.</p>
                    <div class="sub-nav d-flex justify-content-between">
                      <div class="div"><a href="./index.html#gpt4-bots" >Home</a></div>
                      <div class="div">></div>
                      <div class="div"><a href="./mybots.html#active-bots">My Bots</a></div>
                      
                     </div>
                    </div> 

                    <a href="./login.html"  id="register-btn">Rigester Now</a>
                </div>
                

            </div>
         </div>
        </header>


        <section class="container Works">
          <h3 class="heading">How It Works</h3>
          <div class="d-flex">
            <div class="col-12 col-md-4 listeditem">
              <h2><span>1 </span>Sign Up</h2>
              <p>Create an account to get started. Let get you up and running in no time.</p>
            </div>
            <div class="col-12 col-md-4 listeditem">
              <h2><span>2 </span>Deposit</h2>
              <p>Fund your account with a minimum deposit. Choose from a variety of payment options to suit your needs.</p>
            </div>
            <div class="col-12 col-md-4 listeditem">
              <h2><span>3 </span>Invest in Our Automated Bot</h2>
              <p>Allocate your funds to our AI-powered trading bots. They analyze real-time market data to make smart, data-driven trades on your behalf.</p>
            </div>
            <div class="col-12 col-md-4 listeditem">
              <h2><span>4 </span>Earn Returns on Your Investment</h2>
              <p>Watch your profits grow as our bots work tirelessly to optimize your investments. You can monitor your returns and withdraw at any time.</p>
            </div>
          </div>
        </section>
        



        
        



        <div>
          <div class="d-flex justify-content-center">
            <div class="text-center">
              <h3 class="heading" id="gpt4-bots">ChatGPT-4 Powered Trading Bots</h3>
              <p>
                Our bots analyze real-time market data to make precise, data-driven decisions,
                maximizing your trading profits and keeping you ahead of market trends.
              </p>
            </div>
          </div>

          <div class="d-flex flex-wrap justify-content-center m-2" id="bot-container"></div>

        </div>
        



        

      <section class="container performance my-5">
    <h3 class="heading mb-4">Performance & Statistics</h3>
    <p class="lead mb-4">Get a comprehensive overview of our trading performance and key statistics. Stay informed with real-time data and detailed reports to help you make better investment decisions.</p>
    
    <div class="row">
        <div class="col-md-6 col-lg-3 mb-4">
            <div class="card border-primary">
                <div class="card-body text-center">
                    <h5 class="card-title">Total Returns</h5>
                    <p class="card-text">+12.5%</p>
                </div>
            </div>
        </div>
        <div class="col-md-6 col-lg-3 mb-4">
            <div class="card border-success">
                <div class="card-body text-center">
                    <h5 class="card-title">Monthly Gain</h5>
                    <p class="card-text">+3.2%</p>
                </div>
            </div>
        </div>
        <div class="col-md-6 col-lg-3 mb-4">
            <div class="card border-info">
                <div class="card-body text-center">
                    <h5 class="card-title">Number of Trades</h5>
                    <p class="card-text">85</p>
                </div>
            </div>
        </div>
        <div class="col-md-6 col-lg-3 mb-4">
            <div class="card border-warning">
                <div class="card-body text-center">
                    <h5 class="card-title">Active Bots</h5>
                    <p class="card-text">7</p>
                </div>
            </div>
        </div>
    </div>
    
    <h4 class="my-4">Recent Trading Reports</h4>
    <div class="table-responsive">
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Trade Pair</th>
                    <th>Buy Price</th>
                    <th>Sell Price</th>
                    <th>Profit/Loss</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>2024-08-10</td>
                    <td>BTC/USD</td>
                    <td>$25,000</td>
                    <td>$26,000</td>
                    <td>+4.0%</td>
                </tr>
                <tr>
                    <td>2024-08-09</td>
                    <td>ETH/USD</td>
                    <td>$1,800</td>
                    <td>$1,850</td>
                    <td>+2.8%</td>
                </tr>
                <!-- Add more rows as needed -->
            </tbody>
        </table>
    </div>
</section>
          
    </div>


    <script>
      const appStateKey = 'appState'; // Key for storing state in localStorage

const StateManager = {
  // Function to get the current state from localStorage
  getState() {
    const stateJson = localStorage.getItem(appStateKey);
    return stateJson ? JSON.parse(stateJson) : {};
  },

  // Function to save the current state to localStorage and online
  async saveState(newState) {
    const currentState = this.getState();
    const updatedState = { ...currentState, ...newState };
    localStorage.setItem(appStateKey, JSON.stringify(updatedState));

    // Access the user's email from the state object
    const userEmail = updatedState.user?.email;
    const liveDomain = 'https://crypto-invest-server.onrender.com';
    const correcturl = 'http://localhost:3000/users/${userEmail}/updateState';

    if (userEmail) {
      // Save state to the server
      try {
        const response = await fetch(`${liveDomain}:3000/users/${userEmail}/updateState`, {
          method: 'PUT',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(updatedState),
        });

        if (!response.ok) {
          console.error('Failed to save state to server:', response.statusText);
        }
      } catch (error) {
        console.error('Error saving state to server:', error);
        iziToast.error({
            title: 'Slow Connection',
            message: 'Check internet connection.',
            position: 'topCenter',
            timeout: 3500,
            sound: 'path/to/error-sound.mp3', // Replace with the correct path to your sound file
         });
      }
    } else {
      console.error('User email not found in state.');
    }
  },

  // Optional: Function to clear the state
  clearState() {
    localStorage.removeItem(appStateKey);
  },
};

// Check if the saved state in localStorage is empty before assigning
const savedState = StateManager.getState();
const State = Object.keys(savedState).length === 0 ? {} : savedState;

    </script>


    <script>
        // Check if State.activeTradingBots exists, if not, assign an empty array
  let activeTradingBots = State.activeTradingBots || [];
    </script>

    <script>
      // Function to toggle the visibility of the invest section
      function toggleInvestSection(sectionId) {
        const investSection = document.getElementById(sectionId);
        if (investSection) {
          // Toggle the visibility by adding/removing Bootstrap classes
          if (investSection.classList.contains('d-none')) {
            investSection.classList.remove('d-none');
            investSection.classList.add('d-flex');
          } else {
            investSection.classList.remove('d-flex');
            investSection.classList.add('d-none');
          }
        } else {
          console.error('Element with id "' + sectionId + '" not found.');
        }
      }
    </script>


    <script>
      // Simulated data for bots
let bots = [
  {
    id:1,
    pair: "DOGE/USDT",
    type: "Futures Grid",
    dailyGains: 0.05, // Starting gain (slower growth rate)
    drawdown: 0.10, // Starting drawdown
    volatility: 10, // Starting volatility
    coinImage: "./bot/assets/doge.svg",
    graphSrc: "./bot/assets/graph1.png"
  },
  {
    id:2,
    pair: "XRP/USDT",
    type: "Futures Grid",
    dailyGains: 100, // Starting gain (slower growth rate)
    drawdown: 0.12, // Starting drawdown
    volatility: 30, // Starting volatility
    coinImage: "./bot/assets/xrp.svg",
    graphSrc: "./bot/assets/graph2.png"
  },
  {
    id:3,
    pair: "SOL/USDT",
    type: "Futures Grid",
    dailyGains: 100, // Starting gain (slower growth rate)
    drawdown: 0.12, // Starting drawdown
    volatility: 40, // Starting volatility
    coinImage: "./bot/assets/sol.svg",
    graphSrc: "./bot/assets/graph3.png"
  },
  // Add more bot configurations here if needed.
];

// Function to generate a random number within a range
function getRandom(min, max) {
  return (Math.random() * (max - min) + min).toFixed(4); // Decimal places
}

// Function to decide if the price should go up or down
function getUpOrDownProbability(upProbability) {
  return Math.random() < upProbability;
}

// Function to update bot data
function updateBots() {
  bots.forEach((bot, index) => {
    // Determine if the daily gain should increase or decrease
    let upProbability = 0.7; // 70% chance to increase
    let change = parseFloat(getRandom(0.001, 0.005)); // Smaller change amounts
    if (getUpOrDownProbability(upProbability)) {
      bot.dailyGains = Math.max(parseFloat(bot.dailyGains) + change, 0.01); // Minimum value
    } else {
      bot.dailyGains = Math.max(parseFloat(bot.dailyGains) - change, 0.01); // Minimum value
    }

    // Update HTML elements
    const botCard = document.querySelectorAll(".bot-card")[index];
    botCard.querySelector(".gains span").innerText = (bot.dailyGains * 100).toFixed(2) + "%";
    botCard.querySelector(".drawdown span").innerText = (bot.drawdown * 100).toFixed(2) + "%";
    botCard.querySelector(".volatility span").innerText = (bot.volatility * 100).toFixed(2) + "%";
  });
}

// Function to initialize the bots data on page load
function initializeBots() {
  const botContainer = document.querySelector(".d-flex.flex-wrap.justify-content-center");
  bots.forEach((bot) => {
    botContainer.innerHTML += `
      <div class="col-12 col-md-4 bot-card pt-0 pe-0 me-2">
        <div class="d-flex justify-content-end">
          <div class="top-box p-2" style="width: 100px;">
            Top Trader
          </div>
        </div>
        <div class="coinpair-card d-flex justify-content-start">
          <div class="currency-pair p-2 d-flex">
            <div class="coin-image">
              <img src="${bot.coinImage}" alt="Coin Image" class="rounded-circle">
            </div>
            <div class="coin-symbol p-2">
              <h4>${bot.pair}</h4>
              <span>${bot.type}</span>
            </div>
          </div>
        </div>
        <div class="bot-body">
          <div class="row percentage-and-graph d-flex">
            <div class="col-6 percentage d-flex align-items-center">
              <div class="gains">
                <h6>Total Performance</h6>
                <span>${(bot.dailyGains * 100).toFixed(2)}%</span>
              </div>
            </div>
            <div class="col-6 graph d-flex justify-content-end align-items-center">
              <img src="${bot.graphSrc}" alt="Graph Image" class="img-fluid">
            </div>
          </div>
          <div class="d-flex justify-content-between mt-3">
            <div class="col-4 align-items-center">
              <div class="drawdown">
                <h6>Drawdown</h6>
                <span>${(bot.drawdown * 100).toFixed(2)}%</span>
              </div>
            </div>
            <div class="col-4 align-items-center">
              <div class="volatility">
                <h6>Volatility</h6>
                <span>${(bot.volatility * 100).toFixed(2)}%</span>
              </div>
            </div>
            <div class="col-4 d-flex justify-content-end">
                        <button class="copy_button btn btn-primary" id="copy_id_1" onclick="toggleInvestSection('invest_${bot.id}')">Copy</button>
                      </div>
                      </div>
                      <!-- Section to toggle -->
                      <div class="invest mt-3 d-none" id="invest_${bot.id}">
                        <input type="number" class="form-control me-2" id="investmentAmount_${bot.id}" placeholder="Min: $10" min="10" step="0.01">
                        <button class="invest_button btn btn-primary" onclick="addBotToActive(${bot.id})">Invest</button>
                      </div>
          </div>
        </div>
      </div>
    `;
  });
}

// Initialize bots on page load
initializeBots();

// Update bots data periodically (every 5 seconds)
setInterval(updateBots, 5000);
    </script>

<script>
  function addBotToActive(invest_id) {
    const bot_id = invest_id;
    const investAmountInput = document.querySelector("#investmentAmount_" + invest_id);
    
    if (!investAmountInput) {
        console.error("Investment input field not found.");
        return;
    }

    // Retrieve the value from the input field
    const investAmount = investAmountInput.value;

    // Convert the input value to a number
    const investAmountNumber = parseFloat(investAmount);

    // Error checking
    if (isNaN(investAmountNumber)) {
        console.error("Invalid input: Please enter a valid number.");
        iziToast.info({
          title: 'Success',
          message: `Invalid input: Please enter a valid number.`,
          position: 'topCenter',
          timeout: 3500
        });
        return;
    }

    if (investAmountNumber < 10) {
        // console.error("Invalid input: Minimum investment amount is $10.");
        iziToast.error({
            title: 'Error',
            message: 'Invalid input: Minimum investment amount is $10.',
            position: 'topCenter',
            timeout: 3500,
            icon: 'material-icons',
        });
        return;
    }


  // Find the bot by ID
  let bot = bots.find(bot => bot.id === invest_id);


    bot.status = "Active - 5D 2H 32m";
    bot.dailyGains = 1;
    bot.investment = investAmountNumber;
    bot.pnl = 0;
    activeTradingBots.push(bot);
    // console.log(`Bot with ID ${invest_id} added to activeTradingBots.`);

    iziToast.success({
    title: 'Success',
    message: 'Successfuly copied.',
    position: 'topCenter',
    timeout: 3500,
    sound: 'path/to/success-sound.mp3'
});

    //save state
    State.activeTradingBots = activeTradingBots;
    StateManager.saveState(State);
  
}



</script>

<script>
  // Function to update the welcome message
  function updateWelcomeMessage(name) {
    const welcomeSpan = document.querySelector('.welcome-message span');
    if (welcomeSpan) {
      welcomeSpan.textContent = `Welcome, ${name}!`;
    }
  }

  // Example usage: replace "User" with "Alice"
  updateWelcomeMessage(State.user.username);
</script>




    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>